@using MauiApp2.Service
@using MauiApp2.Services;
@inject ToastService ToastService

@if (!string.IsNullOrEmpty(Message))
{
    <div class="toast-container position-fixed top-0 end-0 p-3">
        <div class="toast show fade text-bg-@Type border-0 shadow-lg">
            <div class="toast-body d-flex align-items-center">
                @if (Type == "success")
                {
                    <i class="bi bi-check-circle-fill me-2"></i>
                }
                @if (Type == "warning")
                {
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                }
                @if (Type == "danger")
                {
                    <i class="bi bi-x-circle-fill me-2"></i>
                }
                @if (Type == "info")
                {
                    <i class="bi bi-info-circle-fill me-2"></i>
                }

                <span>@Message</span>
            </div>
        </div>
    </div>
}

@code {
    private string? Message;
    private string Type = "success";

    protected override void OnInitialized()
    {
        ToastService.OnShow += ShowToast;
    }

    private void ShowToast(string message, string type)
    {
        Message = message;
        Type = type;
        InvokeAsync(StateHasChanged);

        _ = Task.Delay(3000).ContinueWith(_ =>
        {
            Message = null;
            InvokeAsync(StateHasChanged);
        });
    }

    public void Dispose()
    {
        ToastService.OnShow -= ShowToast;
    }
}

